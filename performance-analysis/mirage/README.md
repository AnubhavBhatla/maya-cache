<p align="center">
  <h1 align="center"> ChampSim </h1>
  <p> ChampSim is a trace-based simulator for a microarchitecture study. You can find more information about ChampSim here (https://github.com/ChampSim/ChampSim)     <p>
  <p> This repository contains implementation for state-of-the-art randomized caches i.e. CEASER, CEASER-S, and ScatterCache. It also contain our DAMARU attacker code. You can find more information about DAMARU in the paper.
</p>

# Requirements 

This setup is tested with GCC 7.5 and Ubuntu 18.04. To install GCC 7.5 in Ubuntu 20.04 :-

```
sudo apt install build-essential
sudo apt install g++-7
```

# Compile

   
```
Usage:
./build_champsim.sh [BRANCH] [L1D_Pref] [L2C_Pref] [LLC_Pref] [LLC_Replacement] [NUM_CORE] [IS_HUGE_PAGE] [IS_DIVIDED_QUEQUES] [CEASER_S_LLC] [Partition] [Pipelined Encryption Engine] [CEASER LATENCY] [Remapping] [Remap_on_eviction] [LLC_SLICE]

${BRANCH}                         : Branch Predictor
${L1_Pref} {L2C_Pref} {LLC_Pref}  : Prefetcher at L1D,L2C,and LLC respectively
${LLC_Replacement}                : Replacement policy at LLC 
${NUM_CORE}                       : Number of cores
${IS_HUGE_PAGE}                   : Enabling page size of 2 MB 
${IS_DIVIDED_QUEQUES}             : Enabling SMT
${CEASER_S_LLC}                   : Enabling CEASER-S 
${Partition}                      : Number of partition in CEASER-S
${Pipelined_Encryption Engine]    : Nature of the encryption engine {pipelined or non-pipelined}
${CEASER LATENCY}                 : Encryption engine Latency 
${Remapping}                      : Enabling remapping in randomized caches
${Remap_on_eviction}              : Remapping based on the number of LLC evictions
${LLC SLICE}                      : Number of 2 MB LLC Slice

```
Use build_champsim.sh script with proper input arguments to compile different randomized caches. The build_champsim.sh contains knob named "CEASER-S" and "partitions" for building different randomized caches :-

|Knob|CEASER-S|Partitions| Compile
|----------|------------|------------|------------|
|Baseline|0|1|./build_champsim.sh bimodal no no no srrip 1 0 -1  0 1 1 3 0 1 1 |
|[CEASER](http://memlab.ece.gatech.edu/papers/MICRO_2018_2.pdf)|1|1| ./build_champsim.sh bimodal no no no srrip 1 0 -1 1 1 1 3 1 0 1 |
|[CEASER-S](https://memlab.ece.gatech.edu/papers/ISCA_2019_1.pdf)|1|2| ./build_champsim.sh bimodal no no no srrip 1 0 -1 1 2 1 3 1 0 1 |
|[ScatterCache](https://www.usenix.org/system/files/sec19-werner.pdf)|1|16| ./build_champsim.sh bimodal no no no srrip 1 0 -1  1 16 1 3 1 0 1 |

For more details please refer to build_champsim.sh

# Run simulation

Execute `run_champsim.sh` with proper input arguments. <br>

```
Usage: ./run_champsim.sh [BINARY] [N_WARM] [N_SIM] [TRACE] [OPTION]
$ /run_champsim.sh hashed_perceptron-no-no-no-ship-1-1-1-3-1-1-1core-1core_llc 1 1 605.mcf_s-1554B.champsimtrace.xz

${BINARY}: ChampSim binary compiled by "build_champsim.sh" (bimodal-no-no-no-ship-1-1-1-3-1-1-1core-1core_llc)
${N_WARM}: number of instructions for warmup (1 million)
${N_SIM}:  number of instructinos for detailed simulation (1 million)
${TRACE}: trace name (605.mcf_s-1554B.champsimtrace.xz)
${OPTION}: Provide -cvp_trace for running CVP traces.
```

# Replicating the results from the paper

The traces used in evalution can be generated by using pin tool. For each trace, the results are captured for 1M instructions after a warmup of 1M instructions. 


